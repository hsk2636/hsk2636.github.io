<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDA 출고/입고/재입고 프로시저 분석 | pda-procedure-analysis</title>

    <!-- 메인 포트폴리오와 동일 CSS 사용 -->
    <link rel="stylesheet" href="../../style.css?v=6" />

    <!-- 프로젝트 상세 페이지 전용 추가 스타일 -->
    <style>
        .project-page {
            max-width: 900px;
        }

        .project-container {
            margin-top: 24px;
            margin-bottom: 40px;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 12px;
            font-weight: 600;
            background: #eef2ff;
            color: #3730a3;
            border: 1px solid #c7d2fe;
            margin-right: 6px;
        }

        .code-block {
            background: #0f172a;
            color: #e5e7eb;
            padding: 14px 16px;
            border-radius: 10px;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
                "Liberation Mono", "Courier New", monospace;
            font-size: 13px;
            overflow-x: auto;
            margin-bottom: 18px;
        }

        .section-title-sub {
            font-size: 15px;
            font-weight: 700;
            margin: 18px 0 8px;
        }

        .back-link {
            display: inline-block;
            margin-top: 16px;
            font-size: 13px;
            text-decoration: none;
            color: #4f46e5;
        }

        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

<div class="page project-page">

    <!-- ===== 상단 헤더 ===== -->
    <header class="header">
        <h1>PDA 출고/입고/재입고 프로시저 분석</h1>
        <h3>pda-procedure-analysis</h3>
        <p>
            현장 PDA 스캔으로 실행되는 출고·입고·재입고 프로시저(Procedure)를 분석해서  
            LOT 상태 변경 흐름과 ERP 인터페이스 구조를 정리한 PL/SQL 포트폴리오입니다.
        </p>
        <div style="margin-top:14px;">
            <span class="badge">Oracle PL/SQL</span>
            <span class="badge">PDA(Android)</span>
            <span class="badge">Manufacturing IT</span>
        </div>
    </header>

    <!-- ===== 본문 ===== -->
    <main class="project-container">

        <!-- 1. 프로젝트 개요 -->
        <section>
            <h2 class="section-title">프로젝트 개요</h2>
            <p class="text-body">
                이 프로젝트는 제조 현장에서 사용하는 PDA 출고·입고·재입고 기능을 담당하는 
                <b>PL/SQL 프로시저 세트</b>를 분석한 내용입니다.  
                LOT 스캔 → 재고/상태 검증 → 이력 기록(Log) → ERP 인터페이스까지 이어지는
                전체 흐름을 코드 관점에서 정리했습니다.
            </p>
            <p class="text-body">
                특히 출고 유형 <b>ETC / MOV / SAL</b> 구분, 재입고(재고 되돌리기) 처리,  
                공통 로그 패키지(Package)를 이용한 <b>로그 기록 일원화</b>가 주요 포인트입니다.
            </p>
        </section>

        <!-- 2. 파일 구성 -->
        <section>
            <h2 class="section-title">파일 구성</h2>

            <div class="code-block">
<pre><code>pda-procedure-analysis/
 ├─ 01_pda_ship_register.sql      -- PDA 출고 등록 (ETC / MOV / SAL)
 ├─ 02_pda_ship_cancel.sql        -- PDA 출고 취소
 ├─ 03_pda_rereceive_register.sql -- 재입고 등록
 ├─ 04_pda_rereceive_cancel.sql   -- 재입고 취소
 ├─ 05_pkg_pda_log.sql            -- 공통 로그 패키지 (PKG_PDA_LOG)
 └─ README.md                     -- 프로젝트 소개 및 실행 순서</code></pre>
            </div>

            <p class="text-body">
                각 <code>*.sql</code> 파일은 <b>실행 가능한 PL/SQL 스크립트</b> 형식으로 만들어두고,  
                <code>README.md</code>에 실행 순서와 필요한 테스트 데이터 조건을 정리하는 방식입니다.
            </p>
        </section>

        <!-- 3. 핵심 PL/SQL 구조 예시 -->
        <section>
            <h2 class="section-title">핵심 PL/SQL 구조 예시</h2>

            <!-- 3-1 출고 프로시저 예시 -->
            <div class="section-title-sub">1) PDA 출고 등록 프로시저(Ship) 구조</div>
            <div class="code-block">
<pre><code>CREATE OR REPLACE PROCEDURE pr_pda_ship (
      p_lot_no     IN  VARCHAR2
    , p_ship_type  IN  VARCHAR2  -- ETC / MOV / SAL
    , p_user_id    IN  VARCHAR2
    , o_result     OUT VARCHAR2
) IS
    v_err_msg   VARCHAR2(4000);
BEGIN
    -- 1. LOT 존재 / 상태 검증
    SELECT status
      INTO v_status
      FROM tb_lot
     WHERE lot_no = p_lot_no
       FOR UPDATE;

    IF v_status &lt;&gt; 'READY' THEN
        v_err_msg := '출고 불가 상태 LOT 입니다.';
        RAISE_APPLICATION_ERROR(-20001, v_err_msg);
    END IF;

    -- 2. 재고 수량 검증
    PERFORM_STOCK_CHECK(p_lot_no, p_ship_type);  -- 별도 공통 프로시저 가정

    -- 3. 출고 이력 기록
    INSERT INTO tb_ship_hist (
          lot_no, ship_type, ship_dt, user_id
    ) VALUES (
          p_lot_no, p_ship_type, SYSDATE, p_user_id
    );

    -- 4. 재고 차감
    UPDATE tb_inventory
       SET qty = qty - 1
     WHERE lot_no = p_lot_no;

    -- 5. ERP 인터페이스 테이블 적재
    INSERT INTO erp_if_ship (
          lot_no, ship_type, if_flag, create_dt
    ) VALUES (
          p_lot_no, p_ship_type, 'N', SYSDATE
    );

    -- 6. 공통 로그 패키지 호출
    pkg_pda_log.write_log(
          p_lot_no  =&gt; p_lot_no
        , p_action  =&gt; 'SHIP_' || p_ship_type
        , p_message =&gt; '정상 출고 완료'
    );

    o_result := 'OK';

    COMMIT;

EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;

        v_err_msg := 'ERROR : ' || SQLERRM;
        pkg_pda_log.write_log(
              p_lot_no  =&gt; p_lot_no
            , p_action  =&gt; 'SHIP_ERROR'
            , p_message =&gt; v_err_msg
        );
        o_result := v_err_msg;
END pr_pda_ship;
/
</code></pre>
            </div>

            <p class="text-body">
                위 구조는 LOT 검증 → 재고 검증 → 상태 변경 → 이력 기록 → ERP 인터페이스 → 로그 기록까지  
                PDA 출고 처리의 <b>전체 흐름을 한 번에 보여주는 템플릿</b>입니다.
            </p>

            <!-- 3-2 공통 로그 패키지 예시 -->
            <div class="section-title-sub">2) 공통 로그 패키지(Package) 활용</div>
            <div class="code-block">
<pre><code>CREATE OR REPLACE PACKAGE pkg_pda_log IS
    PROCEDURE write_log (
          p_lot_no   IN VARCHAR2
        , p_action   IN VARCHAR2   -- SHIP / RECEIVE / RE-RECEIVE ...
        , p_message  IN VARCHAR2
    );
END pkg_pda_log;
/
CREATE OR REPLACE PACKAGE BODY pkg_pda_log IS

    PROCEDURE write_log (
          p_lot_no   IN VARCHAR2
        , p_action   IN VARCHAR2
        , p_message  IN VARCHAR2
    ) IS
    BEGIN
        INSERT INTO tb_pda_log (
              log_dt, lot_no, action_type, message
        ) VALUES (
              SYSDATE, p_lot_no, p_action, p_message
        );
    END write_log;

END pkg_pda_log;
/
</code></pre>
            </div>

            <p class="text-body">
                출고/입고/재입고 프로시저에서 공통으로 사용하는 <b>로그 기록 로직</b>을  
                패키지(Package)로 분리하면, 각 프로시저에서는  
                <code>pkg_pda_log.write_log(...)</code> 한 줄만 호출해서 로그를 남길 수 있어서
                코드 중복을 크게 줄일 수 있습니다.
            </p>
        </section>

        <!-- 4. 로직 흐름 요약 -->
        <section>
            <h2 class="section-title">로직 흐름 요약</h2>
            <p class="text-body">
                PDA 출고/입고/재입고 프로시저는 공통적으로 아래 순서를 따른다는 걸 정리하였습니다다.
            </p>
            <ul class="text-body">
                <li>① LOT 스캔 → LOT 존재 여부, 상태(STATUS) 검증</li>
                <li>② 재고(Inventory) 수량, 위치 검증</li>
                <li>③ 상태 변경(출고/입고/재입고) 및 수량 차감·증가</li>
                <li>④ 이력 테이블(Hist) 기록</li>
                <li>⑤ ERP 인터페이스 테이블 적재 (IF_FLAG = 'N')</li>
                <li>⑥ 공통 로그 패키지 호출로 작업 결과 메시지 남기기</li>
                <li>⑦ 예외(Exception) 발생 시 ROLLBACK + 오류 메시지 로그 기록</li>
            </ul>
        </section>

        <!-- 5. 활용 포인트 -->
        <section>
            <h2 class="section-title">활용 포인트</h2>
            <ul class="text-body">
                <li>PDA 스캔 기반 물류 흐름을 <b>PL/SQL</b> 구조로 설명할 수 있음</li>
                <li>IN/OUT 파라미터와 예외 처리(Exception Handling) 패턴 연습</li>
                <li>공통 패키지(Package)를 이용한 <b>로그 모듈화</b> 구조 이해</li>
                <li>ERP 인터페이스 테이블과 실제 업무 테이블 간 관계를 코드에서 파악</li>
                <li>실제 프로젝트의 LOT 흐름(출고 → 재입고)을 구조적으로 설명할 수 있는 자료로 활용 가능</li>
            </ul>
        </section>

        <!-- 6. GitHub / 메인으로 돌아가기 -->
        <section>
            <h2 class="section-title">GitHub 레포지토리</h2>
            <p class="text-body">
                실제 예제 PL/SQL 소스 코드는 아래 GitHub 저장소에 정리되어 있습니다.
            </p>
        
            <p class="text-body">
                <a href="https://github.com/hsk2636/hsk2636.github.io/tree/main/projects/pda-procedure-analysis"
                   class="project-link project-link-github"
                   target="_blank" rel="noopener noreferrer">
                    GitHub에서 보기
                </a>
            </p>
        
            <a href="../../index.html" class="back-link">← 메인 포트폴리오로 돌아가기</a>
        </section>

    </main>
</div>

</body>
</html>
